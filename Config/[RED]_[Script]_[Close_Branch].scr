# ScriptVersion:005 MinVersion:8310 MaxVersion:* TargetType:* ModelType:* ScriptType:GIT
import os
import subprocess

def main() -> int:
    """Launches the CICD Python script"""
    try:
        file: str = os.environ.get('WSL_TASK_NAME','')
        file_path: str = os.path.join(os.environ["ProgramFiles"], "WhereScape", "GIT", "Python",  "ed3d_close_branch.py")
        command = [
            "python",
            file_path,
            "--ws3d_repository",
            os.environ.get('WSL_SERVER',''),
            "--ws_app",
            "WSRED",
        ]

        returnvalue = subprocess.Popen(command)

        if returnvalue.stderr != "":
            raise RuntimeError(returnvalue.stdout)

        return 1

    except Exception as error:
        print("Error: %s", error)
        return -1

if __name__ == "__main__":  # Runs main() if file wasn't imported.
    main()
    print(1)
